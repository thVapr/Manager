{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../shared\";\nimport * as i3 from \"../shared/article-helpers/article-meta.component\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../shared/buttons/favorite-button.component\";\nimport * as i6 from \"../shared/buttons/follow-button.component\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"../shared/list-errors.component\";\nimport * as i9 from \"../shared/show-authed.directive\";\nimport * as i10 from \"./article-comment.component\";\nimport * as i11 from \"./markdown.pipe\";\nfunction ArticleComponent_li_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tag_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", tag_r4, \" \");\n  }\n}\nfunction ArticleComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-list-errors\", 24);\n    i0.ɵɵelementStart(2, \"form\", 25);\n    i0.ɵɵlistener(\"ngSubmit\", function ArticleComponent_div_44_Template_form_ngSubmit_2_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.addComment());\n    });\n    i0.ɵɵelementStart(3, \"fieldset\", 26)(4, \"div\", 27);\n    i0.ɵɵelement(5, \"textarea\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 29);\n    i0.ɵɵelement(7, \"img\", 30);\n    i0.ɵɵelementStart(8, \"button\", 31);\n    i0.ɵɵtext(9, \" Post Comment \");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"errors\", ctx_r1.commentFormErrors);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isSubmitting);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formControl\", ctx_r1.commentControl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r1.currentUser.image, i0.ɵɵsanitizeUrl);\n  }\n}\nconst _c0 = function () {\n  return [\"/login\"];\n};\nconst _c1 = function () {\n  return [\"/register\"];\n};\nfunction ArticleComponent_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"a\", 32);\n    i0.ɵɵtext(2, \"Sign in\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" or \");\n    i0.ɵɵelementStart(4, \"a\", 32);\n    i0.ɵɵtext(5, \"sign up\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \" to add comments on this article. \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(2, _c0));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(3, _c1));\n  }\n}\nfunction ArticleComponent_app_article_comment_46_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-article-comment\", 33);\n    i0.ɵɵlistener(\"deleteComment\", function ArticleComponent_app_article_comment_46_Template_app_article_comment_deleteComment_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const comment_r7 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.onDeleteComment(comment_r7));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const comment_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"comment\", comment_r7);\n  }\n}\nconst _c2 = function (a1) {\n  return [\"/editor\", a1];\n};\nconst _c3 = function (a0) {\n  return {\n    disabled: a0\n  };\n};\nexport class ArticleComponent {\n  constructor(route, articlesService, commentsService, router, userService) {\n    this.route = route;\n    this.articlesService = articlesService;\n    this.commentsService = commentsService;\n    this.router = router;\n    this.userService = userService;\n    this.commentControl = new FormControl();\n    this.commentFormErrors = {};\n    this.isSubmitting = false;\n    this.isDeleting = false;\n  }\n  ngOnInit() {\n    // Retreive the prefetched article\n    this.route.data.subscribe(data => {\n      this.article = data.article;\n      // Load the comments on this article\n      this.populateComments();\n    });\n    // Load the current user's data\n    this.userService.currentUser.subscribe(userData => {\n      this.currentUser = userData;\n      this.canModify = this.currentUser.username === this.article.author.username;\n    });\n  }\n  onToggleFavorite(favorited) {\n    this.article.favorited = favorited;\n    if (favorited) {\n      this.article.favoritesCount++;\n    } else {\n      this.article.favoritesCount--;\n    }\n  }\n  onToggleFollowing(following) {\n    this.article.author.following = following;\n  }\n  deleteArticle() {\n    this.isDeleting = true;\n    this.articlesService.destroy(this.article.slug).subscribe(success => {\n      this.router.navigateByUrl('/');\n    });\n  }\n  populateComments() {\n    this.commentsService.getAll(this.article.slug).subscribe(comments => this.comments = comments);\n  }\n  addComment() {\n    this.isSubmitting = true;\n    this.commentFormErrors = {};\n    const commentBody = this.commentControl.value;\n    this.commentsService.add(this.article.slug, commentBody).subscribe(comment => {\n      this.comments.unshift(comment);\n      this.commentControl.reset('');\n      this.isSubmitting = false;\n    }, errors => {\n      this.isSubmitting = false;\n      this.commentFormErrors = errors;\n    });\n  }\n  onDeleteComment(comment) {\n    this.commentsService.destroy(comment.id, this.article.slug).subscribe(success => {\n      this.comments = this.comments.filter(item => item !== comment);\n    });\n  }\n}\nArticleComponent.ɵfac = function ArticleComponent_Factory(t) {\n  return new (t || ArticleComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ArticlesService), i0.ɵɵdirectiveInject(i2.CommentsService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UserService));\n};\nArticleComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ArticleComponent,\n  selectors: [[\"app-article-page\"]],\n  decls: 47,\n  vars: 34,\n  consts: [[1, \"article-page\"], [1, \"banner\"], [1, \"container\"], [3, \"article\"], [3, \"hidden\"], [1, \"btn\", \"btn-sm\", \"btn-outline-secondary\", 3, \"routerLink\"], [1, \"ion-edit\"], [1, \"btn\", \"btn-sm\", \"btn-outline-danger\", 3, \"ngClass\", \"click\"], [1, \"ion-trash-a\"], [3, \"profile\", \"toggle\"], [3, \"article\", \"toggle\"], [1, \"counter\"], [1, \"container\", \"page\"], [1, \"row\", \"article-content\"], [1, \"col-md-12\"], [3, \"innerHTML\"], [1, \"tag-list\"], [\"class\", \"tag-default tag-pill tag-outline\", 4, \"ngFor\", \"ngForOf\"], [1, \"article-actions\"], [1, \"row\"], [1, \"col-xs-12\", \"col-md-8\", \"offset-md-2\"], [4, \"appShowAuthed\"], [3, \"comment\", \"deleteComment\", 4, \"ngFor\", \"ngForOf\"], [1, \"tag-default\", \"tag-pill\", \"tag-outline\"], [3, \"errors\"], [1, \"card\", \"comment-form\", 3, \"ngSubmit\"], [3, \"disabled\"], [1, \"card-block\"], [\"placeholder\", \"Write a comment...\", \"rows\", \"3\", 1, \"form-control\", 3, \"formControl\"], [1, \"card-footer\"], [1, \"comment-author-img\", 3, \"src\"], [\"type\", \"submit\", 1, \"btn\", \"btn-sm\", \"btn-primary\"], [3, \"routerLink\"], [3, \"comment\", \"deleteComment\"]],\n  template: function ArticleComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h1\");\n      i0.ɵɵtext(4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"app-article-meta\", 3)(6, \"span\", 4)(7, \"a\", 5);\n      i0.ɵɵelement(8, \"i\", 6);\n      i0.ɵɵtext(9, \" Edit Article \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function ArticleComponent_Template_button_click_10_listener() {\n        return ctx.deleteArticle();\n      });\n      i0.ɵɵelement(11, \"i\", 8);\n      i0.ɵɵtext(12, \" Delete Article \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"span\", 4)(14, \"app-follow-button\", 9);\n      i0.ɵɵlistener(\"toggle\", function ArticleComponent_Template_app_follow_button_toggle_14_listener($event) {\n        return ctx.onToggleFollowing($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"app-favorite-button\", 10);\n      i0.ɵɵlistener(\"toggle\", function ArticleComponent_Template_app_favorite_button_toggle_15_listener($event) {\n        return ctx.onToggleFavorite($event);\n      });\n      i0.ɵɵtext(16);\n      i0.ɵɵelementStart(17, \"span\", 11);\n      i0.ɵɵtext(18);\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(19, \"div\", 12)(20, \"div\", 13)(21, \"div\", 14);\n      i0.ɵɵelement(22, \"div\", 15);\n      i0.ɵɵpipe(23, \"markdown\");\n      i0.ɵɵelementStart(24, \"ul\", 16);\n      i0.ɵɵtemplate(25, ArticleComponent_li_25_Template, 2, 1, \"li\", 17);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(26, \"hr\");\n      i0.ɵɵelementStart(27, \"div\", 18)(28, \"app-article-meta\", 3)(29, \"span\", 4)(30, \"a\", 5);\n      i0.ɵɵelement(31, \"i\", 6);\n      i0.ɵɵtext(32, \" Edit Article \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function ArticleComponent_Template_button_click_33_listener() {\n        return ctx.deleteArticle();\n      });\n      i0.ɵɵelement(34, \"i\", 8);\n      i0.ɵɵtext(35, \" Delete Article \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(36, \"span\", 4)(37, \"app-follow-button\", 9);\n      i0.ɵɵlistener(\"toggle\", function ArticleComponent_Template_app_follow_button_toggle_37_listener($event) {\n        return ctx.onToggleFollowing($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"app-favorite-button\", 10);\n      i0.ɵɵlistener(\"toggle\", function ArticleComponent_Template_app_favorite_button_toggle_38_listener($event) {\n        return ctx.onToggleFavorite($event);\n      });\n      i0.ɵɵtext(39);\n      i0.ɵɵelementStart(40, \"span\", 11);\n      i0.ɵɵtext(41);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(42, \"div\", 19)(43, \"div\", 20);\n      i0.ɵɵtemplate(44, ArticleComponent_div_44_Template, 10, 4, \"div\", 21);\n      i0.ɵɵtemplate(45, ArticleComponent_div_45_Template, 7, 4, \"div\", 21);\n      i0.ɵɵtemplate(46, ArticleComponent_app_article_comment_46_Template, 1, 1, \"app-article-comment\", 22);\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(ctx.article.title);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"article\", ctx.article);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", !ctx.canModify);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(26, _c2, ctx.article.slug));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(28, _c3, ctx.isDeleting));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"hidden\", ctx.canModify);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"profile\", ctx.article.author);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"article\", ctx.article);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", ctx.article.favorited ? \"Unfavorite\" : \"Favorite\", \" Article \");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"(\", ctx.article.favoritesCount, \")\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind1(23, 24, ctx.article.body), i0.ɵɵsanitizeHtml);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.article.tagList);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"article\", ctx.article);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"hidden\", !ctx.canModify);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(30, _c2, ctx.article.slug));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(32, _c3, ctx.isDeleting));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"hidden\", ctx.canModify);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"profile\", ctx.article.author);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"article\", ctx.article);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", ctx.article.favorited ? \"Unfavorite\" : \"Favorite\", \" Article \");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"(\", ctx.article.favoritesCount, \")\");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"appShowAuthed\", true);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"appShowAuthed\", false);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.comments);\n    }\n  },\n  dependencies: [i1.RouterLink, i3.ArticleMetaComponent, i4.NgClass, i4.NgForOf, i5.FavoriteButtonComponent, i6.FollowButtonComponent, i7.ɵNgNoValidate, i7.DefaultValueAccessor, i7.NgControlStatus, i7.NgControlStatusGroup, i7.NgForm, i7.FormControlDirective, i8.ListErrorsComponent, i9.ShowAuthedDirective, i10.ArticleCommentComponent, i11.MarkdownPipe],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["FormControl","i0","ArticleComponent","constructor","route","articlesService","commentsService","router","userService","ngOnInit","data","subscribe","article","populateComments","currentUser","userData","canModify","username","author","onToggleFavorite","favorited","favoritesCount","onToggleFollowing","following","deleteArticle","isDeleting","destroy","slug","success","navigateByUrl","getAll","comments","addComment","isSubmitting","commentFormErrors","commentBody","commentControl","value","add","comment","unshift","reset","errors","onDeleteComment","id","filter","item","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\vaprm\\Projects\\Manager\\ManagerView\\src\\app\\article\\article.component.ts","C:\\Users\\vaprm\\Projects\\Manager\\ManagerView\\src\\app\\article\\article.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport {\n  Article,\n  ArticlesService,\n  Comment,\n  CommentsService,\n  User,\n  UserService\n} from '../shared';\n\n@Component({\n  selector: 'app-article-page',\n  templateUrl: './article.component.html'\n})\nexport class ArticleComponent implements OnInit {\n  article: Article;\n  currentUser: User;\n  canModify: boolean;\n  comments: Comment[];\n  commentControl = new FormControl();\n  commentFormErrors = {};\n  isSubmitting = false;\n  isDeleting = false;\n\n  constructor(\n    private route: ActivatedRoute,\n    private articlesService: ArticlesService,\n    private commentsService: CommentsService,\n    private router: Router,\n    private userService: UserService,\n  ) { }\n\n  ngOnInit() {\n    // Retreive the prefetched article\n    this.route.data.subscribe(\n      (data: { article: Article }) => {\n        this.article = data.article;\n\n        // Load the comments on this article\n        this.populateComments();\n      }\n    );\n\n    // Load the current user's data\n    this.userService.currentUser.subscribe(\n      (userData: User) => {\n        this.currentUser = userData;\n\n        this.canModify = (this.currentUser.username === this.article.author.username);\n      }\n    );\n  }\n\n  onToggleFavorite(favorited: boolean) {\n    this.article.favorited = favorited;\n\n    if (favorited) {\n      this.article.favoritesCount++;\n    } else {\n      this.article.favoritesCount--;\n    }\n  }\n\n  onToggleFollowing(following: boolean) {\n    this.article.author.following = following;\n  }\n\n  deleteArticle() {\n    this.isDeleting = true;\n\n    this.articlesService.destroy(this.article.slug)\n      .subscribe(\n        success => {\n          this.router.navigateByUrl('/');\n        }\n      );\n  }\n\n  populateComments() {\n    this.commentsService.getAll(this.article.slug)\n      .subscribe(comments => this.comments = comments);\n  }\n\n  addComment() {\n    this.isSubmitting = true;\n    this.commentFormErrors = {};\n\n    const commentBody = this.commentControl.value;\n    this.commentsService\n      .add(this.article.slug, commentBody)\n      .subscribe(\n        comment => {\n          this.comments.unshift(comment);\n          this.commentControl.reset('');\n          this.isSubmitting = false;\n        },\n        errors => {\n          this.isSubmitting = false;\n          this.commentFormErrors = errors;\n        }\n      );\n  }\n\n  onDeleteComment(comment) {\n    this.commentsService.destroy(comment.id, this.article.slug)\n      .subscribe(\n        success => {\n          this.comments = this.comments.filter((item) => item !== comment);\n        }\n      );\n  }\n\n}\n","<div class=\"article-page\">\n\n  <div class=\"banner\">\n    <div class=\"container\">\n      <h1>{{ article.title }}</h1>\n\n      <app-article-meta [article]=\"article\">\n\n          <span [hidden]=\"!canModify\">\n          <a class=\"btn btn-sm btn-outline-secondary\"\n             [routerLink]=\"['/editor', article.slug]\">\n            <i class=\"ion-edit\"></i> Edit Article\n          </a>\n\n          <button class=\"btn btn-sm btn-outline-danger\"\n            [ngClass]=\"{disabled: isDeleting}\"\n            (click)=\"deleteArticle()\">\n            <i class=\"ion-trash-a\"></i> Delete Article\n          </button>\n        </span>\n\n        <span [hidden]=\"canModify\">\n          <app-follow-button\n            [profile]=\"article.author\"\n            (toggle)=\"onToggleFollowing($event)\">\n          </app-follow-button>\n\n          <app-favorite-button\n            [article]=\"article\"\n            (toggle)=\"onToggleFavorite($event)\">\n            {{ article.favorited ? 'Unfavorite' : 'Favorite' }} Article <span class=\"counter\">({{ article.favoritesCount }})</span>\n          </app-favorite-button>\n        </span>\n\n      </app-article-meta>\n    </div>\n  </div>\n\n  <div class=\"container page\">\n\n    <div class=\"row article-content\">\n      <div class=\"col-md-12\">\n\n        <div [innerHTML]=\"article.body | markdown\"></div>\n\n        <ul class=\"tag-list\">\n          <li *ngFor=\"let tag of article.tagList\"\n            class=\"tag-default tag-pill tag-outline\">\n            {{ tag }}\n          </li>\n        </ul>\n\n      </div>\n    </div>\n\n    <hr />\n\n    <div class=\"article-actions\">\n      <app-article-meta [article]=\"article\">\n\n          <span [hidden]=\"!canModify\">\n          <a class=\"btn btn-sm btn-outline-secondary\"\n             [routerLink]=\"['/editor', article.slug]\">\n            <i class=\"ion-edit\"></i> Edit Article\n          </a>\n\n          <button class=\"btn btn-sm btn-outline-danger\"\n            [ngClass]=\"{disabled: isDeleting}\"\n            (click)=\"deleteArticle()\">\n            <i class=\"ion-trash-a\"></i> Delete Article\n          </button>\n        </span>\n\n        <span [hidden]=\"canModify\">\n          <app-follow-button\n            [profile]=\"article.author\"\n            (toggle)=\"onToggleFollowing($event)\">\n          </app-follow-button>\n\n          <app-favorite-button\n            [article]=\"article\"\n            (toggle)=\"onToggleFavorite($event)\">\n            {{ article.favorited ? 'Unfavorite' : 'Favorite' }} Article <span class=\"counter\">({{ article.favoritesCount }})</span>\n          </app-favorite-button>\n        </span>\n\n      </app-article-meta>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-xs-12 col-md-8 offset-md-2\">\n\n        <div *appShowAuthed=\"true\">\n          <app-list-errors [errors]=\"commentFormErrors\"></app-list-errors>\n          <form class=\"card comment-form\" (ngSubmit)=\"addComment()\">\n            <fieldset [disabled]=\"isSubmitting\">\n              <div class=\"card-block\">\n                <textarea class=\"form-control\"\n                  placeholder=\"Write a comment...\"\n                  rows=\"3\"\n                  [formControl]=\"commentControl\"\n                ></textarea>\n              </div>\n              <div class=\"card-footer\">\n                <img [src]=\"currentUser.image\" class=\"comment-author-img\" />\n                <button class=\"btn btn-sm btn-primary\" type=\"submit\">\n                 Post Comment\n                </button>\n              </div>\n            </fieldset>\n          </form>\n        </div>\n\n        <div *appShowAuthed=\"false\">\n          <a [routerLink]=\"['/login']\">Sign in</a> or <a [routerLink]=\"['/register']\">sign up</a> to add comments on this article.\n        </div>\n\n        <app-article-comment\n          *ngFor=\"let comment of comments\"\n          [comment]=\"comment\"\n          (deleteComment)=\"onDeleteComment(comment)\">\n        </app-article-comment>\n\n      </div>\n    </div>\n\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}